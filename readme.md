Code from this stackoverflow question:

https://stackoverflow.com/q/5306282/106092

to test with GHDL.